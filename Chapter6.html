
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 6: Analysis and Synthesis in the Frequency Domain &#8212; Recitations - Omri Dalin</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/tagformat"]}, "tex": {"tags": "ams", "tagformat": {"number": "({number})"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter6';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 7: State-Space Analysis" href="Chapter7.html" />
    <link rel="prev" title="Chapter 5: Root Locus Plots" href="Chapter5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="title.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Recitations - Omri Dalin - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Recitations - Omri Dalin - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="title.html">
                    Intro to Control
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter0.html">Chapter 0: Matrix Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1.html">Chapter 1: The Challenge of Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter2.html">Chapter 2: Linear Time-Invariant Control Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter3.html">Chapter 3: What is a Control System</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter4.html">Chapter 4: PID Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter5.html">Chapter 5: Root Locus Plots</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 6: Analysis and Synthesis in the Frequency Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter7.html">Chapter 7: State-Space Analysis</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Chapter6.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 6: Analysis and Synthesis in the Frequency Domain</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bode-plot">Bode Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-plot">Nyquist Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-stability-theorem">Nyquist Stability Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drawing-the-nyquist-plot">Drawing the Nyquist Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-margins">Stability Margins</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gain-margin">Gain Margin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-margin">Phase Margin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#control-synthesis-in-the-frequency-domain">Control Synthesis in the Frequency Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-lead-compensator">Phase Lead Compensator</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-6-analysis-and-synthesis-in-the-frequency-domain">
<h1>Chapter 6: Analysis and Synthesis in the Frequency Domain<a class="headerlink" href="#chapter-6-analysis-and-synthesis-in-the-frequency-domain" title="Link to this heading">#</a></h1>
<p>If <span class="math notranslate nohighlight">\(\Sigma\)</span> is a stable linear system with transfer function <span class="math notranslate nohighlight">\(G\)</span> then the response to the  input</p>
<div class="math notranslate nohighlight">
\[
    u(t)=\cos(\omega t),
\]</div>
<p>is the output</p>
<div class="math notranslate nohighlight">
\[
    y(t)=A(\omega)\cos(\omega t+\varphi(\omega))+e(t),
\]</div>
<p>where the transient response <span class="math notranslate nohighlight">\(e(t) \)</span> converges to zero, and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A(\omega)&amp;=\big|G(j\omega)\big|\text{ is the  gain at $\omega$,}\\
    \varphi(\omega)&amp;=\arg\big(G(j\omega)\big)\text{ is the  phase shift at $\omega$}.
\end{split}\]</div>
<p>If the input is the sum of sinusoidal terms then, by linearity,  the output will be the sum of the responses to each input term.</p>
<section id="bode-plot">
<h2>Bode Plot<a class="headerlink" href="#bode-plot" title="Link to this heading">#</a></h2>
<p>The Bode plot provides a   graphical representation of the two functions <span class="math notranslate nohighlight">\(A(\omega)\)</span> and <span class="math notranslate nohighlight">\(\varphi(\omega)\)</span>, with a logarithmic <span class="math notranslate nohighlight">\(\omega\)</span>-axis, and with the gain represented logarithmically by <span class="math notranslate nohighlight">\(20\log(A(\omega))\)</span>,  and the phase represented linearly in degrees or radians. The two plots together are called the Bode plot of <span class="math notranslate nohighlight">\(G\)</span>. The logarithmic scales are suitable for looking at several frequency ranges in one glance, and they also make the drawing of the plots easier, because of the appearance of linear asymptotes. The plot with a logarithmic scale in the <span class="math notranslate nohighlight">\(x\)</span>-axis becomes easier using a semi-logarithmic paper.</p>
<p>Suppose that the transfer function <span class="math notranslate nohighlight">\(G\)</span> can be decomposed as <span class="math notranslate nohighlight">\(G=G_1G_2\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
20\log |G(j\omega)|&amp;= 20\log |G_1(j\omega)G_2(j\omega)|\\
&amp;=20\log |G_1(j\omega)|+20\log|G_2(j\omega)|,   
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\arg (G(j\omega))&amp;=\arg ( G_1(j\omega)G_2(j\omega))\\ 
&amp;= \arg ( G_1(j\omega) )+\arg ( G_2(j\omega) ).    
\end{split}\]</div>
<p>Thus, the Bode plot will be   the ``sumâ€™â€™ of the Bode plot of <span class="math notranslate nohighlight">\(G_1\)</span> and the Bode plot of <span class="math notranslate nohighlight">\(G_2\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(G=G_1/G_2\)</span> then a similar calculation gives</p>
<div class="math notranslate nohighlight">
\[
20\log |G(j\omega)|=20\log |G_1(j\omega)|-20\log|G_2(j\omega)|,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\arg (G(j\omega))= \arg ( G_1(j\omega) )-\arg ( G_2(j\omega) ).    
\]</div>
<p>We will typically consider
transfer functions in the form <span class="math notranslate nohighlight">\(G(s)=\frac{n(s)}{d(s)}\)</span>,
where <span class="math notranslate nohighlight">\(n,d\)</span> are polynomials with real coefficients, and the ratio is proper.<br />
Each polynomial can be decomposed as the product of terms in the form <span class="math notranslate nohighlight">\((s-z)\)</span> and <span class="math notranslate nohighlight">\((s^2+2\zeta \omega_ns+\omega^2)\)</span>, and the discussion above implies that it is enough to know  the plots  for the 8 basic
transfer functions listed below.</p>
<p><a class="reference download internal" download="" href="_downloads/c8a0e768f9dcdcb78b1c0b2dff461b6e/BODE_BASIC.pdf"><span class="xref download myst">ðŸ“„ Download the file here</span></a></p>
<p>Generating a Bode plot then reduces to expressing the transfer function using the 8 basic functions described above, and then graphically adding the plots corresponding to each basic function.
For example, given <span class="math notranslate nohighlight">\(G(s)= \frac{s+7}{s-2}\)</span>, we write</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    G(s)&amp;= \frac{7(1+\frac{s}{7} ) }{-2(1+\frac{s}{-2})}\\
    &amp;=( -3.5) \frac{1+\frac{s}{7}  }{1+\frac{s}{-2}},
\end{split}\]</div>
<p>and this  is the product of three basic transfer functions in the form: <span class="math notranslate nohighlight">\(H(s)=k\)</span>, <span class="math notranslate nohighlight">\(H(s)=1+\frac{s}{\omega_n}\)</span> with <span class="math notranslate nohighlight">\(\omega_n&gt;0\)</span>,    and <span class="math notranslate nohighlight">\(H(s)=\frac1{1+\frac{s}{\omega_n}}\)</span> with <span class="math notranslate nohighlight">\(\omega_n&lt;0\)</span>. The Bode plot will thus include the ``graphical sumâ€™â€™ of three basic plots.</p>
</section>
<section id="nyquist-plot">
<h2>Nyquist Plot<a class="headerlink" href="#nyquist-plot" title="Link to this heading">#</a></h2>
<p>An important graphic tool for analyzing the stability of closed-loop systems is the Nyquist plot. It builds on the following important result from complex analysis.</p>
<div class="proof theorem admonition" id="thm:argument">
<p class="admonition-title"><span class="caption-number">Theorem 4 </span></p>
<section class="theorem-content" id="proof-content">
<p>(Cauchyâ€™s argument principle) Let <span class="math notranslate nohighlight">\(\Gamma\)</span> be a simple closed curve in the complex plane oriented in the clockwise direction. Let <span class="math notranslate nohighlight">\(H:\mathbb{C}\to\mathbb{C}\)</span> be a complex function such that</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(H\)</span> is analytic on <span class="math notranslate nohighlight">\(\Gamma\)</span>, and
2.<span class="math notranslate nohighlight">\(H\)</span> is analytic on the domain inside <span class="math notranslate nohighlight">\(\Gamma\)</span> except perhaps on a finite number of points.</p></li>
</ol>
<p>Let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span> be the number of poles of <span class="math notranslate nohighlight">\(H\)</span> inside <span class="math notranslate nohighlight">\(\Gamma\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(Z\)</span>  be the number of zeros of <span class="math notranslate nohighlight">\(H\)</span> inside <span class="math notranslate nohighlight">\(\Gamma\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> be the number of times that the plot <span class="math notranslate nohighlight">\(H(\Gamma)\)</span> encircles the origin in the counter-clockwise direction.</p></li>
</ul>
<p>Then</p>
<div class="math notranslate nohighlight" id="equation-eq-n-p-minus-z">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-n-p-minus-z" title="Link to this equation">#</a></span>\[N=P-Z.\]</div>
</section>
</div><p>In other words, every pole of <span class="math notranslate nohighlight">\(H\)</span> inside <span class="math notranslate nohighlight">\(\Gamma\)</span> contributes one counter-clockwise rotation of <span class="math notranslate nohighlight">\(H(\Gamma)\)</span> around the origin, and every zero of <span class="math notranslate nohighlight">\(H\)</span> inside <span class="math notranslate nohighlight">\(\Gamma\)</span> contributes one  clockwise rotation of <span class="math notranslate nohighlight">\(H(\Gamma)\)</span> around the origin.</p>
<div class="proof example admonition" id="exa:pi1">
<p class="admonition-title"><span class="caption-number">Example 19 </span></p>
<section class="example-content" id="proof-content">
<p>Consider the curve <span class="math notranslate nohighlight">\(\Gamma_1=2e^{j\theta}-7\)</span>, with <span class="math notranslate nohighlight">\(\theta=0^\circ\downarrow -360^\circ\)</span>, that is, a circle of radius 2 centered at <span class="math notranslate nohighlight">\(-7\)</span> in the complex plane,   in the clockwise direction. Consider <span class="math notranslate nohighlight">\(H(s)=\frac1{s+7}\)</span>.
Then <span class="math notranslate nohighlight">\(H\)</span> has no zeros, and one pole at <span class="math notranslate nohighlight">\(-7\)</span>, so <span class="math notranslate nohighlight">\(Z=0\)</span>, <span class="math notranslate nohighlight">\(P=1\)</span>. To plot <span class="math notranslate nohighlight">\(H(\Gamma_1)\)</span>, that is, <span class="math notranslate nohighlight">\(H(s)\)</span> as <span class="math notranslate nohighlight">\(s\)</span> moves along <span class="math notranslate nohighlight">\(\Gamma_1\)</span>, we calculate</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    H(\Gamma_1)&amp; = \frac1{(2e^{j\theta}-7)+7}\\
        &amp;=\frac1{2}e^{-j\theta}.
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(\theta=0^\circ\downarrow -360^\circ\)</span>, we have that <span class="math notranslate nohighlight">\(H(\Gamma_1)\)</span> is a circle with radius <span class="math notranslate nohighlight">\(1/2\)</span> around the origin in the counter-clockwise direction, so <span class="math notranslate nohighlight">\(N=1\)</span>. We see that <span class="math notranslate nohighlight">\(N=P-Z\)</span>.</p>
</section>
</div><div class="proof example admonition" id="exa:pi2">
<p class="admonition-title"><span class="caption-number">Example 20 </span></p>
<section class="example-content" id="proof-content">
<p>Consider the curve <span class="math notranslate nohighlight">\(\Gamma_2=2e^{j\theta}\)</span>, with <span class="math notranslate nohighlight">\(\theta=0^\circ\downarrow -360^\circ\)</span>, that is, a circle of radius 2 centered at <span class="math notranslate nohighlight">\(0\)</span> in the complex plane,    in the clockwise direction. Consider <span class="math notranslate nohighlight">\(H(s)=\frac1{s+7}\)</span>. Then <span class="math notranslate nohighlight">\(Z=0\)</span>, <span class="math notranslate nohighlight">\(P=0\)</span>.  To plot <span class="math notranslate nohighlight">\(H(\Gamma_2)\)</span>, that is, <span class="math notranslate nohighlight">\(H(s)\)</span> as <span class="math notranslate nohighlight">\(s\)</span> moves along <span class="math notranslate nohighlight">\(\Gamma_2\)</span>, we calculate</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    H(\Gamma_2)&amp; = \frac1{(2e^{j\theta})+7}\\
    &amp;=\frac{ 2e^{-j\theta} +7}{(2e^{j\theta} +7)(2e^{-j\theta} +7) }\\
    &amp;=\frac{ 2e^{-j\theta} +7}{53+28\cos(\theta) }
\end{split}\]</div>
<p>The numerator here  is a circle or radius 2 centered at <span class="math notranslate nohighlight">\(7\)</span>. The denominator is always a positive number larger than <span class="math notranslate nohighlight">\(1\)</span>. Thus, <span class="math notranslate nohighlight">\(N=0\)</span> and we see that <span class="math notranslate nohighlight">\(N=P-Z\)</span>.</p>
</section>
</div><p><a class="reference internal" href="#thm:argument">Theorem 4</a> implies that by knowing any two out of <span class="math notranslate nohighlight">\(N,P,Z\)</span>, we can deduce the third value.</p>
<p>Let <span class="math notranslate nohighlight">\(G \)</span> be the
loop gain of a closed-loop system. The sensitivity function is then <span class="math notranslate nohighlight">\(\frac{1}{1+G}\)</span>. Suppose that
<span class="math notranslate nohighlight">\(G(s)=n(s)/d(s)\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[
S=\frac{d}{d+n}.
\]</div>
<p>The zeros of <span class="math notranslate nohighlight">\(S\)</span> are just the zeros of <span class="math notranslate nohighlight">\(d\)</span>, which are the poles of <span class="math notranslate nohighlight">\(G\)</span>. To determine the  stability of <span class="math notranslate nohighlight">\(S\)</span>, we need to determine how many poles it has in the right-hand side of the complex plane.</p>
<p>Introduce a special curve, denoted <span class="math notranslate nohighlight">\(\Gamma_N\)</span>,  that includes three parts:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =0 \uparrow \infty\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=Re^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(R\to\infty\)</span> and <span class="math notranslate nohighlight">\(\theta =90^\circ \downarrow  -90^\circ\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =-\infty \uparrow 0\)</span>,</p></li>
</ol>
<p>see <a class="reference internal" href="#fig-gamman"><span class="std std-numref">Fig. 22</span></a>. Thus, <span class="math notranslate nohighlight">\(\Gamma_N\)</span> encircles the right-half plane in the clockwise direction.</p>
</section>
<section id="nyquist-stability-theorem">
<h2>Nyquist Stability Theorem<a class="headerlink" href="#nyquist-stability-theorem" title="Link to this heading">#</a></h2>
<p>The Nyquist plot of <span class="math notranslate nohighlight">\(G\)</span> is the plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span>.</p>
<div class="proof theorem admonition" id="thm:nyq_general">
<p class="admonition-title"><span class="caption-number">Theorem 5 </span></p>
<section class="theorem-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(G=n/d\)</span> be the ratio of two polynomials such that <span class="math notranslate nohighlight">\(G\)</span> has no poles on the imaginary axis.  Let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span>  be the number of poles of <span class="math notranslate nohighlight">\(G\)</span> in the right-half plane,</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> be the number of counter-clockwise rotations of <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span> around the point <span class="math notranslate nohighlight">\(-1\)</span> in the complex plane.</p></li>
</ul>
<p>Then the number of poles of <span class="math notranslate nohighlight">\(S=\frac1{1+G}\)</span> in the right-half plane is <span class="math notranslate nohighlight">\(P-N\)</span>.</p>
</section>
</div><p>Thus, <span class="math notranslate nohighlight">\(S\)</span> is stable if and only if <span class="math notranslate nohighlight">\(P=N\)</span>.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Prove  <a class="reference internal" href="#thm:nyq_general">Theorem 5</a> based on  <a class="reference internal" href="#thm:argument">Theorem 4</a>.</p>
</div>
<figure class="align-default" id="fig-gamman">
<a class="reference internal image-reference" href="_images/nyquist_contour.png"><img alt="_images/nyquist_contour.png" src="_images/nyquist_contour.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">The curve <span class="math notranslate nohighlight">\(\Gamma_N\)</span> includes three  parts.</span><a class="headerlink" href="#fig-gamman" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="proof example admonition" id="example-4">
<p class="admonition-title"><span class="caption-number">Example 21 </span></p>
<section class="example-content" id="proof-content">
<p>Consider <span class="math notranslate nohighlight">\(G(s)=\frac{s^2+100.1s+10}{s^2+5s+100}\)</span>. The denominator is a second-order polynomial with positive coefficients, so <span class="math notranslate nohighlight">\(P=0\)</span>.
The Nyquist plot of  <span class="math notranslate nohighlight">\(G\)</span> is depicted in <a class="reference internal" href="#fig-nyqui-pl-g"><span class="std std-numref">Fig. 23</span></a>, and we see that <span class="math notranslate nohighlight">\(N=0\)</span>. Thus, the number of unstable poles of
<span class="math notranslate nohighlight">\(S=\frac1{1+G}\)</span> is zero, so <span class="math notranslate nohighlight">\(S\)</span> is stable.</p>
</section>
</div><figure class="align-default" id="fig-nyqui-pl-g">
<a class="reference internal image-reference" href="_images/nyquist_1.png"><img alt="_images/nyquist_1.png" src="_images/nyquist_1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Nyquist plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span> for  <span class="math notranslate nohighlight">\(G(s)=\frac{s^2+100.1s+10}{s^2+5s+100}\)</span>.</span><a class="headerlink" href="#fig-nyqui-pl-g" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="proof remark admonition" id="rem:modified_nyquist">
<p class="admonition-title"><span class="caption-number">Remark 12 </span></p>
<section class="remark-content" id="proof-content">
<p>If <span class="math notranslate nohighlight">\(G\)</span> has poles on the imaginary  axis then the Nyquist theorem can still be used once  the curve <span class="math notranslate nohighlight">\(\Gamma_N\)</span> is modified. Suppose that <span class="math notranslate nohighlight">\(G\)</span> has a pole <span class="math notranslate nohighlight">\(ja\)</span>, with <span class="math notranslate nohighlight">\(a\geq 0 \)</span>, and then also a pole <span class="math notranslate nohighlight">\(-ja\)</span>. Then <span class="math notranslate nohighlight">\(\Gamma_N\)</span> should be modified to include the following parts:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =0 \uparrow a^-\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=ja+r e^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(r\to 0 \)</span> and <span class="math notranslate nohighlight">\(\theta =-90^\circ \uparrow  90^\circ\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =a^+ \uparrow \infty\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=Re^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(R\to\infty\)</span> and <span class="math notranslate nohighlight">\(\theta =90^\circ \downarrow  -90^\circ\)</span> ,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =-\infty \uparrow -a^+\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=-ja+r e^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(r\to 0 \)</span> and <span class="math notranslate nohighlight">\(\theta =-90^\circ \uparrow  90^\circ\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =-a^- \uparrow 0\)</span>,</p></li>
</ol>
<p>see <a class="reference internal" href="#fig-modified-nyq"><span class="std std-numref">Fig. 24</span></a>.</p>
</section>
</div><figure class="align-default" id="fig-modified-nyq">
<a class="reference internal image-reference" href="_images/nyquist_contour_with_poles.png"><img alt="_images/nyquist_contour_with_poles.png" src="_images/nyquist_contour_with_poles.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">The modified curve <span class="math notranslate nohighlight">\(\Gamma_N\)</span> when <span class="math notranslate nohighlight">\(G\)</span> has poles at <span class="math notranslate nohighlight">\(ja\)</span> and <span class="math notranslate nohighlight">\(-ja\)</span>.</span><a class="headerlink" href="#fig-modified-nyq" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>If <span class="math notranslate nohighlight">\(G\)</span> is stable then the value <span class="math notranslate nohighlight">\(P\)</span> defined  in <a class="reference internal" href="#thm:nyq_general">Theorem 5</a> satisfies <span class="math notranslate nohighlight">\(P=0\)</span>, and this yields the following result.</p>
<div class="proof theorem admonition" id="thm:nyq_special">
<p class="admonition-title"><span class="caption-number">Theorem 6 </span></p>
<section class="theorem-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(G=n/d\)</span> be the ratio of two polynomials such that <span class="math notranslate nohighlight">\(G\)</span> is stable.  Then <span class="math notranslate nohighlight">\(S=\frac1{1+G}\)</span> is stable
if and only if the Nyquist plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span> does not encircle (or hit)
the point <span class="math notranslate nohighlight">\(-1\)</span> in the complex plane.</p>
</section>
</div></section>
<section id="drawing-the-nyquist-plot">
<h2>Drawing the Nyquist Plot<a class="headerlink" href="#drawing-the-nyquist-plot" title="Link to this heading">#</a></h2>
<p>There are several ways to draw <span class="math notranslate nohighlight">\(G(\Gamma_n)\)</span>. Note that to apply the Nyquist stability criterion the plot does not have to be completely  accurate, as the only information we need is the number of rotations around the point <span class="math notranslate nohighlight">\(-1\)</span> in the complex plane.</p>
<p>Recall that when <span class="math notranslate nohighlight">\(G\)</span> has no poles on the imaginary axis, <span class="math notranslate nohighlight">\(\Gamma_n\)</span> includes three parts:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =0 \uparrow \infty\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=Re^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(R\to\infty\)</span> and <span class="math notranslate nohighlight">\(\theta =90^\circ \downarrow  -90^\circ\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s=j\omega\)</span> with <span class="math notranslate nohighlight">\(\omega =-\infty \uparrow 0\)</span>,</p></li>
</ol>
<p>see <a class="reference internal" href="#fig-gamman"><span class="std std-numref">Fig. 22</span></a>.</p>
<p>The transfer function <span class="math notranslate nohighlight">\(G\)</span> is typicality the proper ratio of two polynomials with real coefficients. This implies that: (1) the arc
<span class="math notranslate nohighlight">\(s=Re^{j\theta}\)</span>, with <span class="math notranslate nohighlight">\(R\to\infty\)</span> and <span class="math notranslate nohighlight">\(\theta =90^\circ \downarrow  -90^\circ\)</span>, is mapped by <span class="math notranslate nohighlight">\(G\)</span> to a single point; and (2) the plots <span class="math notranslate nohighlight">\(G(j\omega)\)</span> for <span class="math notranslate nohighlight">\(\omega=-\infty \uparrow 0\)</span> and for <span class="math notranslate nohighlight">\(\omega=0\uparrow \infty\)</span> are symmetric with respect to the real axis.</p>
<p>Consider thus <span class="math notranslate nohighlight">\(G(j\omega)\)</span> with <span class="math notranslate nohighlight">\(\omega:0\uparrow\infty\)</span>. The magnitude and angle of every point on this curve is exactly the information  in the Bode plot of <span class="math notranslate nohighlight">\(G\)</span>.
We conclude that one  possibility is to first draw the Bode plot of <span class="math notranslate nohighlight">\(G\)</span> and then use this to draw the Nyquist plot.</p>
<div class="proof example admonition" id="example-7">
<p class="admonition-title"><span class="caption-number">Example 22 </span></p>
<section class="example-content" id="proof-content">
<p>Consider the transfer function <span class="math notranslate nohighlight">\(G(s)=\frac{s^2+100.1s+10}{s^2+5s+100}\)</span>. The Bode plot of <span class="math notranslate nohighlight">\(G\)</span> is depicted in  <a class="reference internal" href="#fig-bode-for-nyquist"><span class="std std-numref">Fig. 25</span></a>.
We will use this to plot the Nyquist curve for <span class="math notranslate nohighlight">\(G\)</span>. Consider <span class="math notranslate nohighlight">\(G(j\omega)\)</span> with <span class="math notranslate nohighlight">\(\omega:0\uparrow \infty\)</span>. For <span class="math notranslate nohighlight">\(\omega=0\)</span>, we have <span class="math notranslate nohighlight">\(G(j0)=\frac{10}{100}=0.1\)</span>. This corresponds to
<span class="math notranslate nohighlight">\(|G(j0)|=-20dB\)</span> and <span class="math notranslate nohighlight">\(\arg G(j0)=0^\circ\)</span>. As <span class="math notranslate nohighlight">\(\omega\)</span> increases,  we see from the Bode plot that first the gain increases and the phase increases to almost <span class="math notranslate nohighlight">\(90^\circ\)</span>. Then
the angle decreases to <span class="math notranslate nohighlight">\(0^\circ\)</span>,   to <span class="math notranslate nohighlight">\(\approx -45^\circ \)</span> and then increases again to <span class="math notranslate nohighlight">\(0^\circ\)</span>. This yields the solid curve in the Nyquist plot of <span class="math notranslate nohighlight">\(G\)</span> in  <a class="reference internal" href="#fig-nyqui-pl-g"><span class="std std-numref">Fig. 23</span></a>. This curve ends at the point</p>
<div class="math notranslate nohighlight">
\[
\lim_{\omega\to\infty} G(j\omega)=\lim_{\omega\to\infty}\frac{(j\omega)^2}{(j\omega)^2}=1.
\]</div>
<p>The arc <span class="math notranslate nohighlight">\(s=Re^{j\theta }\)</span>, with <span class="math notranslate nohighlight">\(R\to\infty\)</span>, is also mapped by <span class="math notranslate nohighlight">\(G\)</span> to the point <span class="math notranslate nohighlight">\(1\)</span>. The part <span class="math notranslate nohighlight">\(s=j\omega\)</span>, with <span class="math notranslate nohighlight">\(\omega:-\infty\uparrow 0\)</span> is mapped to a plot that is symmetric with respect to the real axis to the plot we already generated. This completes the Nyquist plot in <a class="reference internal" href="#fig-nyqui-pl-g"><span class="std std-numref">Fig. 23</span></a>.</p>
</section>
</div><figure class="align-default" id="fig-bode-for-nyquist">
<a class="reference internal image-reference" href="_images/bode_plot_of_g.png"><img alt="_images/bode_plot_of_g.png" src="_images/bode_plot_of_g.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Bode plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span> for  <span class="math notranslate nohighlight">\(G(s)=\frac{s^2+100.1s+10}{s^2+5s+100}\)</span>.</span><a class="headerlink" href="#fig-bode-for-nyquist" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Another way to draw the Nyquist plot is by substituting the parametric representation of <span class="math notranslate nohighlight">\(\Gamma_N\)</span> in <span class="math notranslate nohighlight">\(G \)</span>. The next example demonstrates this.</p>
<div class="proof example admonition" id="example-8">
<p class="admonition-title"><span class="caption-number">Example 23 </span></p>
<section class="example-content" id="proof-content">
<p>Consider again the transfer function <span class="math notranslate nohighlight">\(G(s)=\frac{s^2+100.1s+10}{s^2+5s+100}\)</span>. To plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span>, we begin by substituting <span class="math notranslate nohighlight">\(s=j\omega\)</span> in <span class="math notranslate nohighlight">\(G(s)\)</span>. This gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
        G(j\omega)&amp;= \frac{-\omega^2+100.1j\omega+10}
        {100-\omega^2+5j\omega }\\
        &amp;=\frac{\omega^4+395.5\omega^2+1000+j(-96.1\omega^2+10060 )\omega }{(100-\omega^2)^2+(5\omega)^2}.
\end{split}\]</div>
<p>Suppose that <span class="math notranslate nohighlight">\(\omega=0\uparrow \infty\)</span>. The real part of <span class="math notranslate nohighlight">\(G(j\omega )\)</span> is always positive. For <span class="math notranslate nohighlight">\(\omega=0\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[
    G(j0) =\frac{1000}{100^2}=0.1.
\]</div>
<p>As <span class="math notranslate nohighlight">\(\omega\)</span> increases from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>,  we see that for small values of <span class="math notranslate nohighlight">\(\omega\)</span> we have that  <span class="math notranslate nohighlight">\(\text{Img}(G(j\omega))\)</span> is positive, so the curve is in the first orthant. For <span class="math notranslate nohighlight">\(\omega\approx 10\)</span>, we get <span class="math notranslate nohighlight">\(\text{Img}(G(j\omega))=0\)</span>, so the curve crosses the positive part of the real axis. As <span class="math notranslate nohighlight">\(\omega\)</span> further increases, the imaginary part remains negative, and as <span class="math notranslate nohighlight">\(\omega\to \infty\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[
    \lim_{\omega\to\infty}G(j\omega)  =\lim_{\omega\to\infty}\frac{\omega^4  }{ \omega^4}=1.
\]</div>
<p>This yields the solid curve in  <a class="reference internal" href="#fig-nyqui-pl-g"><span class="std std-numref">Fig. 23</span></a>.
The part <span class="math notranslate nohighlight">\(s=Re^{j\theta}\)</span> with <span class="math notranslate nohighlight">\(R\to infty\)</span> is mapped by <span class="math notranslate nohighlight">\(G\)</span> to the point <span class="math notranslate nohighlight">\(1\)</span>. The part <span class="math notranslate nohighlight">\(s=j\omega\)</span>, with <span class="math notranslate nohighlight">\(\omega:-\infty\uparrow 0\)</span> is mapped to a plot that is symmetric with respect to the real axis to the plot we already generated. This completes the Nyquist plot in  <a class="reference internal" href="#fig-nyqui-pl-g"><span class="std std-numref">Fig. 23</span></a>.</p>
</section>
</div></section>
<section id="stability-margins">
<h2>Stability Margins<a class="headerlink" href="#stability-margins" title="Link to this heading">#</a></h2>
<p>So far, we considered stability as a binary problem: the closed-loop system is stable or not. The Nyquist stability theorem allows to derive a notion of stability margins by testing ``how farâ€™â€™ is the Nyquist plot <span class="math notranslate nohighlight">\(G(\Gamma_N) \)</span> from encircling the point <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<section id="gain-margin">
<h3>Gain Margin<a class="headerlink" href="#gain-margin" title="Link to this heading">#</a></h3>
<p>We consider the loop gain <span class="math notranslate nohighlight">\(G=PC\)</span>.</p>
<div class="proof definition admonition" id="definition-9">
<p class="admonition-title"><span class="caption-number">Definition 7 </span></p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\omega_c&gt;0\)</span> be the frequency such that <span class="math notranslate nohighlight">\(G(j\omega_c)\)</span> is real and negative. The gain margin (GM) of <span class="math notranslate nohighlight">\(G\)</span> is</p>
<div class="math notranslate nohighlight">
\[
-20 \log |G(j\omega_c)| \text{ (in dB).}
\]</div>
</section>
</div><p>Generally speaking, a larger gain margin implies ``more stabilityâ€™â€™ of <span class="math notranslate nohighlight">\(S=\frac1{1+G}\)</span>. To explain this, let <span class="math notranslate nohighlight">\( x:=-G(j\omega_c)\)</span>,  so <span class="math notranslate nohighlight">\(x&gt;0\)</span>. If <span class="math notranslate nohighlight">\(x=1\)</span> then <span class="math notranslate nohighlight">\(G(j\omega_c)=-1\)</span>, so the Nyquist plot <span class="math notranslate nohighlight">\(G(\Gamma_N)\)</span> â€˜â€˜touchesâ€™â€™ the point <span class="math notranslate nohighlight">\(-1\)</span>. We would thus like the difference <span class="math notranslate nohighlight">\(-x-(-1)\)</span> to be as large as possible, that is,    that the difference <span class="math notranslate nohighlight">\(\frac1{|G(j\omega_c)|}-1\)</span> will be large as possible, that is, that the GM will be as large as possible.</p>
<p>If there is no frequency <span class="math notranslate nohighlight">\(\omega_c\)</span> such that <span class="math notranslate nohighlight">\(G(j\omega_c)=-180^\circ\)</span> then GM is defined as infinity.</p>
<p>The GM can be read from the Bode plot of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<div class="proof example admonition" id="example-10">
<p class="admonition-title"><span class="caption-number">Example 24 </span></p>
<section class="example-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(G(s)=\frac{10}{s(1+0.2s)(1+0.02s)}\)</span>. <a class="reference internal" href="#fig-gm"><span class="std std-numref">Fig. 26</span></a> depicts a Bode plot of <span class="math notranslate nohighlight">\(G\)</span>. From this plot, we first find  the frequency <span class="math notranslate nohighlight">\(\omega_c\)</span>  where <span class="math notranslate nohighlight">\(G(j\omega_c)=-180^\circ\)</span> (this is marked by an arrow in the figure).  Then the
GM of <span class="math notranslate nohighlight">\(G\)</span> is  the distance  in dB between <span class="math notranslate nohighlight">\(G(j\omega_c) \)</span> and the value 0 dB.</p>
</section>
</div><figure class="align-default" id="fig-gm">
<a class="reference internal image-reference" href="_images/bode_plot_of_G1.png"><img alt="_images/bode_plot_of_G1.png" src="_images/bode_plot_of_G1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Gain and phase margins of <span class="math notranslate nohighlight">\(G(s)=\frac{10}{s(1+0.2s)(1+0.02s)}\)</span>.</span><a class="headerlink" href="#fig-gm" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="phase-margin">
<h3>Phase Margin<a class="headerlink" href="#phase-margin" title="Link to this heading">#</a></h3>
<p>Another measure of quantitative   stability of the closed-loop system  is the phase margin.</p>
<div class="proof definition admonition" id="definition-11">
<p class="admonition-title"><span class="caption-number">Definition 8 </span></p>
<section class="definition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\omega_g&gt;0\)</span> be the frequency such that <span class="math notranslate nohighlight">\(|G(j\omega_g)|=1\)</span>. The phase margin of <span class="math notranslate nohighlight">\(G\)</span> is</p>
<div class="math notranslate nohighlight">
\[
    \arg(G(j\omega_g))-(-180^\circ) \text{ (in degrees)}.
\]</div>
</section>
</div><p>To explain this, note that if <span class="math notranslate nohighlight">\(\arg(G(j\omega_g))=-180^\circ\)</span> then <span class="math notranslate nohighlight">\(G(j\omega_g)=-1\)</span>, so the Nyquist plot <span class="math notranslate nohighlight">\(G(\Gamma_n)\)</span> ``touchesâ€™â€™ the point <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>Generally speaking, a larger phase  margin implies â€˜â€˜more stabilityâ€™â€™ of <span class="math notranslate nohighlight">\(S=\frac1{1+G}\)</span>.</p>
<p>If there is no frequency <span class="math notranslate nohighlight">\(\omega_g\)</span> such that <span class="math notranslate nohighlight">\(|G(j\omega_g)|=1\)</span> then PM is defined as infinity.</p>
<p>The PM can be read from the Bode plot of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<div class="proof example admonition" id="example-12">
<p class="admonition-title"><span class="caption-number">Example 25 </span></p>
<section class="example-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(G(s)=\frac{10}{s(1+0.2s)(1+0.02s)}\)</span>. <a class="reference internal" href="#fig-pm"><span class="std std-numref">Fig. 27</span></a> depicts a Bode plot of <span class="math notranslate nohighlight">\(G\)</span>. From this plot, we first find  the frequency <span class="math notranslate nohighlight">\(\omega_g\)</span>  where <span class="math notranslate nohighlight">\(G(j\omega_g)\)</span> is 0 dB  (this is marked by an arrow in the figure).  Then the  PM of <span class="math notranslate nohighlight">\(G\)</span> is  the distance   between <span class="math notranslate nohighlight">\(\arg (G(j\omega_g) )\)</span> and the value <span class="math notranslate nohighlight">\(-180^\circ\)</span>.</p>
</section>
</div><figure class="align-default" id="fig-pm">
<a class="reference internal image-reference" href="_images/bode_plot_of_G_with_PM.png"><img alt="_images/bode_plot_of_G_with_PM.png" src="_images/bode_plot_of_G_with_PM.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">Gain and phase margins of <span class="math notranslate nohighlight">\(G(s)=\frac{10}{s(1+0.2s)(1+0.02s)}\)</span>.</span><a class="headerlink" href="#fig-pm" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="proof example admonition" id="example-13">
<p class="admonition-title"><span class="caption-number">Example 26 </span></p>
<section class="example-content" id="proof-content">
<p>Suppose that the plant <span class="math notranslate nohighlight">\(P(s)=\frac{50}{s(s+1)(s+10)}\)</span> is controlled in a closed-loop system with controller <span class="math notranslate nohighlight">\(C(s)=1\)</span>. We compute the GM and PM.     In this case, <span class="math notranslate nohighlight">\(G(s)=P(s)\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
G(j\omega) = \frac{50}{j\omega(j\omega+1)(j\omega+10)}=
\frac{1}{\omega}\cdot\frac{-550\omega+(50\omega^2-500)j}{\omega^4+101\omega^2+100}.
\]</div>
<p>We see that <span class="math notranslate nohighlight">\(G(j\omega)\)</span> will be real and negative at the frequency <span class="math notranslate nohighlight">\(\omega_c=\sqrt{10}\approx 3.16\)</span>. At this frequency, we have</p>
<div class="math notranslate nohighlight">
\[
G(j\omega_c) =\frac1{\sqrt{10}} \cdot \frac{-550\sqrt{10}}{100+1010+100}=\frac{-55}{121}.
\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[
GM=-20\log |\frac{-55}{121} |=6.85\; \text{dB}. 
\]</div>
<p>We turn to computing PM.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
|G(j\omega)| &amp; =
\frac{1}{\omega}\cdot\frac{ \sqrt{(550\omega)^2+(50\omega^2-500)^2}}{\omega^4+101\omega^2+100}\\
&amp;=\frac1{\omega}\cdot \frac{50\sqrt{\omega^4+101\omega^2+100} }{\omega^4+101\omega^2+100}\\
&amp;=\frac{1}{\omega}\cdot\frac{50}{\sqrt{\omega^4+101\omega^2+100}}.
\end{split}\]</div>
<p>We look for a frequency <span class="math notranslate nohighlight">\(\omega_g\)</span> such that <span class="math notranslate nohighlight">\(|G(j\omega_g)|=1\)</span>, that is,
<span class="math notranslate nohighlight">\(50=\omega_g \sqrt{\omega_g^4+101\omega_g^2+100}\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
2500=\omega_g^6+101\omega_g^4+100\omega_g^2.
\]</div>
<p>Letting <span class="math notranslate nohighlight">\(v_g:=\omega_g^2\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
2500=(v_g^2+101v_g+100 )v_g,
\]</div>
<p>so <span class="math notranslate nohighlight">\(v_g=4.42\)</span> and <span class="math notranslate nohighlight">\(\omega_g=2.1\)</span>. At this frequency,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\arg G(j\omega_g)&amp;=\arg (-500\cdot 2.1+(50\cdot 2,1^2-500)j)\\
&amp;= \arg (-1155-279.5 j )\\
&amp;=-90^\circ-\tan^{-1}(\frac{1155}{279.5})\\
&amp;=-166.4^\circ.
\end{split}\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[
PM=\arg G(j\omega_j)+180^\circ=13.6^\circ.
\]</div>
</section>
</div><div class="proof remark admonition" id="remark-14">
<p class="admonition-title"><span class="caption-number">Remark 13 </span></p>
<section class="remark-content" id="proof-content">
<p>Usually, <span class="math notranslate nohighlight">\(GM\geq 6\)</span> dB and <span class="math notranslate nohighlight">\(PM \geq 30^\circ\)</span> are considered to be good.</p>
</section>
</div><p>So far, we  considered the GM and PM as tools to analyze how stable a given  closed-loop system is. But, these can also be used as design specifications.</p>
</section>
</section>
<section id="control-synthesis-in-the-frequency-domain">
<h2>Control Synthesis in the Frequency Domain<a class="headerlink" href="#control-synthesis-in-the-frequency-domain" title="Link to this heading">#</a></h2>
<p>We begin with an example.</p>
<div class="proof example admonition" id="example-15">
<p class="admonition-title"><span class="caption-number">Example 27 </span></p>
<section class="example-content" id="proof-content">
<p>Consider a closed-loop system composed of a plant</p>
<div class="math notranslate nohighlight">
\[
    P(s)=\frac{1}{s(1+s)(1+\frac{s}{80})},
\]</div>
<p>and a controller <span class="math notranslate nohighlight">\(C\)</span>. Design <span class="math notranslate nohighlight">\(C\)</span> such that</p>
<ol class="arabic simple">
<li><p>the closed-loop system is stable;</p></li>
<li><p>the steady-state error for a ramp input is no more than <span class="math notranslate nohighlight">\(1\%\)</span>, that is, <span class="math notranslate nohighlight">\(|e_{ss}(ramp)|\leq 0.01\)</span>.</p></li>
</ol>
<p>We begin by trying a gain controller <span class="math notranslate nohighlight">\(C(s)=k\)</span>. The closed-loop transfer function is</p>
<div class="math notranslate nohighlight">
\[
    \frac{\hat y(s)}{\hat r(s)} = \frac{P(s)C(s)}{1+P(s)C(s)}
=\frac{kP(s)}{1+kP(s)}  ,  
\]</div>
<p>so for ramp input</p>
<div class="math notranslate nohighlight">
\[\begin{split}
e_{ss}(ramp)&amp;= \lim_{s\to 0} \frac1{skP(s)}\\
&amp;=
\frac1{k},     
\end{split}\]</div>
<p>assuming that the limit exists. To satisfy the second requirement, we must take <span class="math notranslate nohighlight">\(k\geq 100\)</span>.</p>
<p>Set <span class="math notranslate nohighlight">\(k=100\)</span>. To analyze the stability of the closed loop system, we draw a Nyquist plot of <span class="math notranslate nohighlight">\(100P(s)\)</span>. Note that since <span class="math notranslate nohighlight">\(P\)</span> has a pole at the origin, we use a modified <span class="math notranslate nohighlight">\(\Gamma_N\)</span> as explained in <a class="reference internal" href="#rem:modified_nyquist">Remark 12</a>.
The Nyquist plot of <span class="math notranslate nohighlight">\(100P(s)\)</span>
is depicted in <a class="reference internal" href="#fig-nyq-100"><span class="std std-numref">Fig. 28</span></a>.</p>
<figure class="align-default" id="fig-nyq-100">
<a class="reference internal image-reference" href="_images/nyquist100new.png"><img alt="_images/nyquist100new.png" src="_images/nyquist100new.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">Nyquist plot of <span class="math notranslate nohighlight">\(100P(s)\)</span>.</span><a class="headerlink" href="#fig-nyq-100" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To analyze stability of the closed-loop system, we calculate the value <span class="math notranslate nohighlight">\(-x\)</span> in the figure. Note that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    100P(j\omega)&amp;=\frac{100}{j\omega(1+j\omega)(1+\frac{j\omega}{80})}\\
    &amp;=\frac{-100j}{ \omega(1+j\omega)(1+\frac{j\omega}{80})}\\
    &amp;=\frac{ -101.25  \omega -100 j( 1-\frac{\omega^2}{80})}
    {\omega(1+\omega^2)(1+(\frac{\omega}{80})^2)}  . 
    %%%%%
\end{split}\]</div>
<p>Thus, the frequency <span class="math notranslate nohighlight">\(\omega_g\)</span> such that <span class="math notranslate nohighlight">\(100P(j\omega_g)\)</span>  is <span class="math notranslate nohighlight">\(\omega_g=\sqrt{80}\)</span>, and at this frequency we have</p>
<div class="math notranslate nohighlight" id="equation-eq-8081">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-8081" title="Link to this equation">#</a></span>\[\begin{split}    100P(j\omega_g)
    &amp;=\frac{ -101.25  \sqrt{80}  }
    {\sqrt{80} (1+80)(1+(\frac{1}{\sqrt{80} })^2)}\nonumber\\&amp;=-100/81.\end{split}\]</div>
<p>Thus, <span class="math notranslate nohighlight">\(-x=-100/81&lt;-1\)</span> and this implies that the Nyquist plot in <a class="reference internal" href="#fig-nyq-100"><span class="std std-numref">Fig. 28</span></a> includes two encirclements of the point <span class="math notranslate nohighlight">\(-1\)</span> in the CW direction. We now apply <a class="reference internal" href="#thm:nyq_general">Theorem 5</a> (see also <a class="reference internal" href="#rem:modified_nyquist">Remark 12</a>).
The number of poles   of <span class="math notranslate nohighlight">\(100P\)</span> in the right-half plane is zero. The number of   of CCW rotations of <span class="math notranslate nohighlight">\(100P(\Gamma_N)\)</span> around the point <span class="math notranslate nohighlight">\(-1\)</span> in the complex plane is <span class="math notranslate nohighlight">\(-2\)</span>, so the number of right-half poles of <span class="math notranslate nohighlight">\(S=\frac1{1+100P}\)</span>   is <span class="math notranslate nohighlight">\(2\)</span> and, in particular, the closed-loop system is unstable. It follows from <a class="reference internal" href="#equation-eq-8081">(34)</a> that the closed-loop system is unstable for any <span class="math notranslate nohighlight">\(k&gt;81\)</span>.</p>
<p>The conclusion from this example is that we require a controller in the form <span class="math notranslate nohighlight">\(kC\)</span>, with <span class="math notranslate nohighlight">\(k\geq 100\)</span>,
such that <span class="math notranslate nohighlight">\(C\)</span> stabilizes the closed-loop system.</p>
</section>
</div><section id="phase-lead-compensator">
<h3>Phase Lead Compensator<a class="headerlink" href="#phase-lead-compensator" title="Link to this heading">#</a></h3>
<p>A phase lead compensator is a network that introduces a positive phase shift to a systemâ€™s frequency response, thereby improving its transient response and increasing its stability margins.</p>
<p>The phase lead compensator has the form</p>
<div class="math notranslate nohighlight" id="equation-eq-plc">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-plc" title="Link to this equation">#</a></span>\[C(s)=\frac{1+\tau s}{1+\alpha \tau s} \text{  with  } 0&lt;\tau, \;0&lt;\alpha&lt;1. \]</div>
<p>Note that this is in normalized form in the sense that <span class="math notranslate nohighlight">\(C(0)=1\)</span>, so it will not affect the value of the steady state error.
The  phase lead compensator has a stable zero at <span class="math notranslate nohighlight">\(-1/\tau\)</span>, and a stable pole at <span class="math notranslate nohighlight">\(-1/(\alpha\tau)\)</span>.<br />
An asymptotic Bode plot of <span class="math notranslate nohighlight">\(C\)</span> is depicted in <a class="reference internal" href="#fig-asym-bode"><span class="std std-numref">Fig. 29</span></a> in blue line. An accurate plot (red dashed line) is also shown.</p>
<figure class="align-default" id="fig-asym-bode">
<a class="reference internal image-reference" href="_images/asym_bode.png"><img alt="_images/asym_bode.png" src="_images/asym_bode.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">Bode plot of the phase lead compensator. Blue line: asymptotic plot; Red dashed line: accurate plot.</span><a class="headerlink" href="#fig-asym-bode" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It may be seen that <span class="math notranslate nohighlight">\(C\)</span> always has a positive phase. This implies that for any plant <span class="math notranslate nohighlight">\(P\)</span> we have that <span class="math notranslate nohighlight">\(PC\)</span> has a higher gain margin than <span class="math notranslate nohighlight">\(P\)</span>. Furthermore, there is a unique frequency <span class="math notranslate nohighlight">\(\omega_M\)</span> such that <span class="math notranslate nohighlight">\(\phi_M:=\arg(C(j\omega_M))\)</span> is the maximal   phase   that <span class="math notranslate nohighlight">\(C\)</span> can contribute, with</p>
<div class="math notranslate nohighlight" id="equation-eq-bounds-omega-m">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-bounds-omega-m" title="Link to this equation">#</a></span>\[0^\circ&lt;\phi_M&lt;90^\circ.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(C(j\omega)=\frac{1+\tau j\omega}{1+\alpha\tau j \omega}\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
\arg(C(j\omega))=\tan^{-1}(\tau\omega)-\tan^{-1} (\alpha\tau\omega).
\]</div>
<p>Using the formula</p>
<div class="math notranslate nohighlight">
\[
\tan(a-b)=\frac{\tan(a)-\tan(b)}{1+\tan(a)\tan(b)}
\]</div>
<p>yields</p>
<div class="math notranslate nohighlight" id="equation-eq-tan-arg">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-tan-arg" title="Link to this equation">#</a></span>\[\tan(\arg(C(j\omega)))=\frac{\tau\omega(1-\alpha )}{1+\alpha\tau^2\omega^2}.\]</div>
<p>Differentiating this with respect to <span class="math notranslate nohighlight">\(\omega \)</span> and comparing to zero gives</p>
<div class="math notranslate nohighlight">
\[
0=1-\alpha \tau^2 \omega^2,
\]</div>
<p>so</p>
<div class="math notranslate nohighlight" id="equation-eq-oemag-m">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-oemag-m" title="Link to this equation">#</a></span>\[\omega_M=\frac1{\tau \sqrt{\alpha}}.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\frac{1}{\tau}&lt;\omega_M &lt;\frac{1}{\alpha\tau}\)</span> (see <a class="reference internal" href="#fig-asym-bode"><span class="std std-numref">Fig. 29</span></a>). Using <a class="reference internal" href="#equation-eq-tan-arg">(37)</a> we get that the maximal phase satisfies</p>
<div class="math notranslate nohighlight">
\[
\tan(\phi_M)=\frac{\tau\omega_M(1-\alpha )}{1+\alpha\tau^2\omega_M^2} 
= \frac{1-\alpha}{2\sqrt{\alpha}}.
\]</div>
<p>Using the trigonometric identity <span class="math notranslate nohighlight">\(\sin(\theta) =\frac{\tan(\theta)}{\sqrt{1+\tan^2(\theta)}}\)</span> which holds in the range <span class="math notranslate nohighlight">\(\theta\in[0^\circ,90^\circ]\)</span> (see <a class="reference internal" href="#equation-eq-bounds-omega-m">(36)</a>) gives</p>
<div class="math notranslate nohighlight">
\[
\sin(\phi_M)=\frac{1-\alpha}{1+\alpha}, 
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-eq-alpha-and-phi-m">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-alpha-and-phi-m" title="Link to this equation">#</a></span>\[\alpha = \frac{1-\sin(\phi_M)}{1+\sin(\phi_M)}.\]</div>
<p>A calculation shows that</p>
<div class="math notranslate nohighlight" id="equation-eq-c-mag-at-phi-m">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-c-mag-at-phi-m" title="Link to this equation">#</a></span>\[20\log(  |C(j\omega_M)|)\approx \frac1{2} 20 \log (\frac1{\alpha})=-10\log(\alpha).\]</div>
<p>We now have all the data needed to design a phase lead compensator <span class="math notranslate nohighlight">\(C\)</span>
as a controller:</p>
<ol class="arabic simple">
<li><p>Draw Bode plots of the plant <span class="math notranslate nohighlight">\(P\)</span> and determine GM and PM;</p></li>
<li><p>Calculate, according to the design specifications, the needed additional phase, and set <span class="math notranslate nohighlight">\(\phi_M\)</span> to be this value;</p></li>
<li><p>Obtain the parameter <span class="math notranslate nohighlight">\(\alpha\)</span> of <span class="math notranslate nohighlight">\(C\)</span> from <a class="reference internal" href="#equation-eq-alpha-and-phi-m">(39)</a>;</p></li>
<li><p>Find  a frequency <span class="math notranslate nohighlight">\(\omega_1&gt;0\)</span> such that <span class="math notranslate nohighlight">\(20\log|P(j\omega_1)|=10\log(\alpha)\)</span>, and set <span class="math notranslate nohighlight">\(\omega_M=\omega_1\)</span>.  Obtain the parameter <span class="math notranslate nohighlight">\(\tau\)</span> of <span class="math notranslate nohighlight">\(C\)</span> from <a class="reference internal" href="#equation-eq-oemag-m">(38)</a>;</p></li>
<li><p>Since <span class="math notranslate nohighlight">\(\alpha,\tau\)</span> have been determined, this completes the design of <span class="math notranslate nohighlight">\(C\)</span>. Verify that the closed-loop system satisfies the design specifications.</p></li>
</ol>
<p>To explain this procedure, note that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    20\log|P(j\omega_1)C(j\omega_1)| &amp;= 20\log|P(j\omega_1)|+ 20\log|C(j\omega_1)|\\
    &amp;=10\log(\alpha) +20\log|C(j\omega_M)|\\
    &amp;=10 \log(\alpha) -10\log(\alpha)\\&amp;=0.
\end{split}\]</div>
<p>Thus, the frequency where we compute  the PM of the system is <span class="math notranslate nohighlight">\(\omega_1=\omega_M\)</span>, and this is the frequency where <span class="math notranslate nohighlight">\(C\)</span> provides the maximal phase <span class="math notranslate nohighlight">\(\phi_M\)</span>.</p>
<div class="proof example admonition" id="example-16">
<p class="admonition-title"><span class="caption-number">Example 28 </span></p>
<section class="example-content" id="proof-content">
<p>Consider the plant</p>
<div class="math notranslate nohighlight">
\[
    P(s)=\frac{100}{s(1+0.04 s)}.
\]</div>
<p>Design a closed-loop controller such that:</p>
<ol class="arabic simple">
<li><p>PM <span class="math notranslate nohighlight">\(\geq 45^\circ\)</span>; and</p></li>
<li><p>the steady state error to a ramp input  <span class="math notranslate nohighlight">\(\leq 1\%\)</span>.</p></li>
</ol>
<p>We will design a controller in the form <span class="math notranslate nohighlight">\(kC\)</span>, with <span class="math notranslate nohighlight">\(C\)</span> a phase lead compensator. We first determine the gain <span class="math notranslate nohighlight">\(k\)</span> based on the steady state error requirement</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    e_{ss}(ramp) &amp;= \lim_{s\to 0}\frac1{s(1+kP(s)C(s))} \\
    &amp;=\frac{0.01}{k}.
\end{split}\]</div>
<p>Thus, it is enough to take <span class="math notranslate nohighlight">\(k=1\)</span>. <a class="reference internal" href="#fig-bode-plot-kp"><span class="std std-numref">Fig. 30</span></a>
depicts a Bode plot of <span class="math notranslate nohighlight">\(kP=P\)</span>.
We see that PM=<span class="math notranslate nohighlight">\(28^\circ\)</span>, attained at the frequency <span class="math notranslate nohighlight">\(\omega_c=47\)</span> (rad/sec), so the PM requirement does not hold.
To meet the requirement PM<span class="math notranslate nohighlight">\(\geq 45^\circ\)</span>, we design a compensator with <span class="math notranslate nohighlight">\(\phi_M=25^\circ\)</span>. Now <a class="reference internal" href="#equation-eq-alpha-and-phi-m">(39)</a> gives</p>
<div class="math notranslate nohighlight">
\[
\alpha=\frac{1-\sin(25^\circ)}{1+\sin(25^\circ)}\approx 0.40586.
\]</div>
<p>The next step is to determine the frequency <span class="math notranslate nohighlight">\(\omega_1\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
|kP(j\omega_1)|_{dB}=10\log(\alpha)=-3.91625. 
\]</div>
<p>From the Bode plot we find that <span class="math notranslate nohighlight">\(\omega_1\approx 60\)</span>, so we set <span class="math notranslate nohighlight">\(\omega_M=60\)</span>. Now <a class="reference internal" href="#equation-eq-oemag-m">(38)</a> gives</p>
<div class="math notranslate nohighlight">
\[
\tau=0.02616.
\]</div>
<p>Summarizing, the designed controller is</p>
<div class="math notranslate nohighlight">
\[
k \frac{1+\tau s}{1+\alpha \tau s } = k\frac{1+0.2616 s}{1+0.0106 s},
\]</div>
<p>with <span class="math notranslate nohighlight">\(k=1\)</span>, and</p>
<div class="math notranslate nohighlight">
\[
P(s)C(s)= \frac{100}{s(1+0.04s)}\cdot \frac{1+0.2616 s}{1+0.0106 s}.
\]</div>
<p><a class="reference internal" href="#fig-bode-corrected"><span class="std std-numref">Fig. 31</span></a> shows the Bode plot of <span class="math notranslate nohighlight">\(PC\)</span>. Now   PM=<span class="math notranslate nohighlight">\(47.6^\circ\)</span>.</p>
</section>
</div><figure class="align-default" id="fig-bode-plot-kp">
<a class="reference internal image-reference" href="_images/bode_p_k1.png"><img alt="_images/bode_p_k1.png" src="_images/bode_p_k1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Bode plot of <span class="math notranslate nohighlight">\(kP=P\)</span>.</span><a class="headerlink" href="#fig-bode-plot-kp" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-bode-corrected">
<a class="reference internal image-reference" href="_images/bode_corrected_plc.png"><img alt="_images/bode_corrected_plc.png" src="_images/bode_corrected_plc.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Bode plot of <span class="math notranslate nohighlight">\(PC\)</span>.</span><a class="headerlink" href="#fig-bode-corrected" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 5: Root Locus Plots</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter7.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 7: State-Space Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bode-plot">Bode Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-plot">Nyquist Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-stability-theorem">Nyquist Stability Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drawing-the-nyquist-plot">Drawing the Nyquist Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-margins">Stability Margins</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gain-margin">Gain Margin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-margin">Phase Margin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#control-synthesis-in-the-frequency-domain">Control Synthesis in the Frequency Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-lead-compensator">Phase Lead Compensator</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Omri Dalin
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>